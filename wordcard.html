<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>单词卡片学习</title>
  <style>
    body { background: #f5f6fa; }
    .container { position: relative; width: 500px; margin: 40px auto; }
    .word-btn {
      position: absolute;
      border-radius: 50%;
      width: 28px; height: 28px;
      background: #fff;
      border: 1px solid #ccc;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 1px 4px #0002;
      cursor: pointer;
      z-index: 3;
      transition: background 0.2s, border 0.2s;
    }
    .word-btn.active {
      background: #4a90e2;
      border: 2px solid #4a90e2;
      animation: flash 0.5s alternate infinite;
    }
    @keyframes flash {
      0% { box-shadow: 0 0 0 0 #4a90e2; }
      100% { box-shadow: 0 0 12px 4px #4a90e2; }
    }
    .start-btn {
      margin-top: 20px; width: 100%; font-size: 18px; padding: 10px 0;
      border-radius: 8px; border: 1px solid #4a90e2; background: #4a90e2; color: #fff; cursor: pointer;
    }
    .card-mask {
      position: fixed; left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.3); z-index: 10;
      display: flex; align-items: center; justify-content: center;
    }
    .card {
      background: #fff; border-radius: 12px; padding: 32px; min-width: 320px; min-height: 220px;
      box-shadow: 0 4px 24px #0003; position: relative;
      animation: fadein 0.2s;
    }
    @keyframes fadein { from { opacity: 0; transform: scale(0.95);} to { opacity: 1; transform: scale(1);} }
    .close-btn {
      position: absolute; right: 16px; top: 16px; background: none; border: none; font-size: 22px; cursor: pointer;
    }
    .card-nav { margin-top: 24px; display: flex; justify-content: space-between; }
    .card-nav button {
      padding: 6px 18px; font-size: 16px; border-radius: 6px; border: 1px solid #ccc;
      background: #fff; cursor: pointer;
    }
    .card-nav button:disabled { background: #eee; cursor: not-allowed; }
    .speak-btn {
      background: #f5f5f5; border: 1px solid #ccc; border-radius: 50%; width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center; cursor: pointer; margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <img id="main-img" src="word-card.png" alt="word card" style="width:100%;display:block;">
    <!-- 单词按钮会通过JS插入 -->
    <button id="startBtn" class="start-btn">开始学习</button>
  </div>
  <!-- 卡片弹窗 -->
  <div id="cardMask" class="card-mask" style="display:none;">
    <div class="card" onclick="event.stopPropagation()">
      <button class="close-btn" id="closeCardBtn" title="关闭">×</button>
      <div id="cardContent"></div>
      <div class="card-nav">
        <button id="prevPageBtn">上一页</button>
        <button id="nextPageBtn">下一页</button>
      </div>
    </div>
  </div>
  <script>
    // 单词数据
    const words = [
      {
        text: "Crown",
        x: 0.68, y: 0.13,
        definition: "n. 王冠，皇冠；v. 为……加冕",
        example: "The king wore a golden crown.",
        memory: "联想：crown像'皇冠'，国王头上的装饰。"
      },
      {
        text: "Sceptre",
        x: 0.54, y: 0.06,
        definition: "n. 权杖，象征王权的杖",
        example: "The queen held a sceptre in her hand.",
        memory: "联想：sceptre的p像权杖的形状。"
      },
      {
        text: "Empress",
        x: 0.88, y: 0.45,
        definition: "n. 女皇，皇后",
        example: "The empress ruled the country wisely.",
        memory: "联想：empress=em(母亲)+press(压)，母亲般的统治者。"
      },
      {
        text: "Empresss",
        x: 0.13, y: 0.28,
        definition: "n. 女皇（拼写有误，实际应为Empress）",
        example: "The empresss was kind to her people.",
        memory: "联想：同Empress，注意拼写。"
      }
    ];

    // 动态插入单词按钮
    const container = document.querySelector('.container');
    let wordBtns = [];
    words.forEach((w, i) => {
      const btn = document.createElement('button');
      btn.className = 'word-btn';
      btn.style.left = (w.x * 100) + '%';
      btn.style.top = (w.y * 100) + '%';
      btn.title = `查看 ${w.text} 卡片`;
      btn.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M16 2v4"/><path d="M8 2v4"/></svg>`;
      btn.onclick = () => showCard(i, 0);
      container.appendChild(btn);
      wordBtns.push(btn);
    });

    // 卡片弹窗逻辑
    const cardMask = document.getElementById('cardMask');
    const cardContent = document.getElementById('cardContent');
    const prevPageBtn = document.getElementById('prevPageBtn');
    const nextPageBtn = document.getElementById('nextPageBtn');
    const closeCardBtn = document.getElementById('closeCardBtn');
    let cardWordIdx = 0, cardPage = 0;

    function showCard(idx, page) {
      cardWordIdx = idx;
      cardPage = page;
      renderCard();
      cardMask.style.display = '';
    }
    function hideCard() {
      cardMask.style.display = 'none';
    }
    closeCardBtn.onclick = hideCard;
    cardMask.onclick = hideCard;

    prevPageBtn.onclick = () => {
      if (cardPage > 0) {
        cardPage--;
        renderCard();
      }
    };
    nextPageBtn.onclick = () => {
      if (cardPage < 2) {
        cardPage++;
        renderCard();
      }
    };

    function speak(word, repeat = 1) {
      let count = 0;
      function play() {
        if (count < repeat) {
          const utter = new window.SpeechSynthesisUtterance(word);
          utter.lang = "en-US";
          utter.onend = () => {
            count++;
            play();
          };
          window.speechSynthesis.speak(utter);
        }
      }
      play();
    }

    function renderCard() {
      const w = words[cardWordIdx];
      let html = '';
      if (cardPage === 0) {
        html = `<h2 style="margin-bottom:8px;">${w.text}</h2>
          <div style="margin-bottom:16px;">${w.definition}</div>
          <button class="speak-btn" onclick="speak('${w.text}',3);event.stopPropagation();"
            title="播放发音">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19 5c1.5 2 1.5 8 0 10"/><path d="M15 9.5c.5 1 .5 4 0 5"/></svg>
          </button>`;
      } else if (cardPage === 1) {
        html = `<h3>例句</h3><div style="margin-top:16px;font-size:18px;">${w.example}</div>`;
      } else {
        html = `<h3>联想记忆</h3><div style="margin-top:16px;font-size:18px;">${w.memory}</div>`;
      }
      cardContent.innerHTML = html;
      prevPageBtn.disabled = cardPage === 0;
      nextPageBtn.disabled = cardPage === 2;
    }

    // "开始学习"功能
    const startBtn = document.getElementById('startBtn');
    let learning = false, learningIdx = 0;
    startBtn.onclick = () => {
      if (learning) return;
      learning = true;
      learningIdx = 0;
      startBtn.disabled = true;
      playNext(0);
    };

    function playNext(idx) {
      if (idx >= words.length) {
        learning = false;
        startBtn.disabled = false;
        wordBtns.forEach(btn => btn.classList.remove('active'));
        return;
      }
      wordBtns.forEach((btn, i) => btn.classList.toggle('active', i === idx));
      const utter = new window.SpeechSynthesisUtterance(words[idx].text);
      utter.lang = "en-US";
      utter.onend = () => {
        playNext(idx + 1);
      };
      window.speechSynthesis.speak(utter);
    }
  </script>
</body>
</html> 
